It is proved in the previous chapters that segmented germanium detectors are powerful of distinguishing between single-site events and multi-site events. However, (1) there are some multi-site events which are confined to one segment and (2) there are some single-site events that happen on the boundary between two segments. The \textit{boundary events} are rejected erroneously, because the energy deposited is shared between segments. The analysis of the electrical pulses associated with the events (pulse shape analysis) can help with both problem categories. For events in category (1) the time development of the pulse can reveal a multi-site event; while for events in category (2) the relative strength of the two pulses plus the additional mirror pulses can reveal whether the interaction position is near the boundary or not. Pulse shape analysis can also help with several other aspects: rejection of background from $\alpha$-particle and neutron interactions with detectors, Compton continuum suppression~\cite{comcon}, detection of crystal structure~\cite{agata}, etc. In combination with crystal segmentation, pulse shape analysis plays a crucial role to reach an extremely low background count rate.

To estimate the efficiency of the pulse shape analysis data samples which can mimic the behavior the $0\nu\beta\beta$ decay events need to be collected. Two data samples commonly used are (1) double escape events and (2) single Compton scattering events~\cite{scoms}. However,
the double escape peaks are normally not located near the Q-value for double beta decay of $^{76}$Ge. In addition, the events from the peak are not uniformly distributed throughout the detector crystal~\cite{major}. The single Compton scattering events are collected with a very low event rate. The low rate is intrinsic to the measurement and makes it difficult and time consuming to collect samples of satisfactory size. Therefore the data have to be complemented by reliable pulse shape simulation.

\section{Procedure of pulse shape simulation}
\label{sec:pss:proc}
The procedure of the pulse shape simulation~\cite{agata} can be described as follows:
\begin{enumerate}
\item Simulate the interactions of particles with the detector   crystals by using MaGe~\cite{Mag08} to get the distribution and   amplitudes of the energy deposits of the interactions;
\item Translate the energy deposits into electron-hole pairs, i.e.   the charge carriers;
\item Calculate the electrical field and weighting potential in the   crystal according to the high voltage applied to the detector, also   taking into account differences in impurities;
\item Simulate the carrier drift at the calculated electrical field   taking into account the crystal orientation dependent anisotropy of   the drift velocities;
\item Calculate the time development of the charges induced in the   electrodes by the carriers drift~\cite{igex}; (For segmented   germanium detectors, the mirror charges induced in the neighboring   segments can also be calculated.)
\item Finally calculate the pulse shapes by taking into account the   electrical parameters such as the detector's resistance and   capacity, pre-amplifier's response and noise, cross talks between   segments, etc.
\end{enumerate}
An Object-Oriented pulse shape simulation package written in C++ is being co-developed by the GERGA and Majorana MC groups. It covers every aspect of the procedure. The calculation of the electric fields and potentials is described in Sec.~\ref{sec:pss:field}. For the calculation of the charge carriers drift velocities please see Sec.~\ref{sec:pss:drift}.

\section{Calculation of electric and weighting fields}
\label{sec:pss:field}

\section{Calculation of charge carrier drift velocities}
\label{sec:pss:drift}
\subsection{Mobility}
\label{sec:pss:mobi}
Following a $\gamma$-ray interaction, the produced electron-hole pairs
will separated and start to drift under the influence of the
electrostatic field produced by the potential applied on the detector
electrodes. One can define the mobility $\mu_{e,h}$ of the electrons
$e$ and holes $h$ as the variable which gives the relation between the
electric field $\mathbf{E}(\mathbf{r})$ and the drift velocity
\begin{equation}
  \label{eq:pss:mobi}
  \mathbf{v}(\mathbf{r}) = \mu_{e,h} \mathbf{E}(\mathbf{r}),
\end{equation}
where $\mathbf{r}$ indicates the position. $\mu_{e,h}$ depend on the
temperature, the electric field and the structure of the germanium
crystal. As long as the electron and hole temperatures do not differ
much from the lattice temperature, the drift velocity is proportional
to the electrical field and the lattice orientation has no influence.
In this case the mobility can be simplified to just a number
$\mu_{e,h} = \mu_{0}$. In germanium detectors cooled at liquid
nitrogen temperature the electron/hole pairs are hotter than the
lattice. The drift velocity in this condition is influenced by the
crystal lattice orientation and not always parallel to the applied
electrical field.

Germanium has the same crystalline structure as silicon and diamond, namely, a face-centered cubic (FCC) structure, in which each atom lies at the center of a regular tetrahedron, and is surrounded at its apices by four atoms as shown in Fig.~\ref{fig:pss:xtal}
\begin{figure}[tbhp]
  \centering
  \includegraphics[width=0.6\textwidth]{xtalStruc}  
  \caption{Structure of germanium crystal.}
  \label{fig:pss:xtal}
\end{figure}

Due to the crystal lattice symmetry in germanium, in three directions, the crystallographic $\langle100\rangle$, $\langle110\rangle$ and $\langle111\rangle$, the mobility is always aligned with the electrical field. Consequently, the drift velocity is aligned with the symmetry axis as well. Therefore we can obtain the longitudinal anisotropy of the drift mobility in these special directions. Experimental data on the longitudinal anisotropy in these specific directions can be found in literature. The mobility data can be well fitted in any principal crystallographic direction with the parameterization:
\begin{equation}
  \label{eq:pss:para}
  v = \frac{\mu_{0}E}{[1+(\frac{E}{E_{0}})^{\beta}]^{1/\beta}} -   \mu_{n}E,
\end{equation}
where $E, v$ are the magnitudes of the electric field and drift velocity, respectively, $\mu_{0}, \mu_{n}, E_{0}$ and $\beta$ are the fitting parameters. At low fields, the mobility becomes isotropic and therefore the mobility fit parameter $\mu_{0}$ is expected to become independent of the crystallographic direction. For hot electrons, the departure from a linear $v \sim E$ relation is modeled through the parameters $E_{0}$ and $\beta$. At high field, Mihailescu \textit{et   al.}~\cite{miha} have added the term $\mu_{n}E$ to account for the \emph{Gunn effect} that was observed by Ottaviani \textit{et   al.}~\cite{otta} for field strengths above 3~kV$/$cm at 80~K. However, this effect is insignificant in our detector operated with field strengths 10-300~V$/$mm. Parameterization values fitted with the experimental data are summarized in Table~\ref{tab:pss:pars}. The values from two different references are quite different from each other.

\begin{table}[tbhp]
  \centering
  \begin{tabular*}{\textwidth}{ccccccc}\hline\hline
     Reference & Carrier & Direction & $\mu_{0} \left[ \frac{\mbox{cm}^{2}}{\mbox{V}\cdot\mbox{s}} \right]$ & $E_{0} \left[ \frac{\mbox{V}}{\mbox{cm}} \right]$ & $\beta$ & $\mu_{n} \left[ \frac{\mbox{cm}^{2}}{\mbox{V}\cdot\mbox{s}} \right]$ \\\hline
& Electron & $\langle111\rangle$ & 40180 & 493 & 0.72 & 589 \\
Ref.~\cite{miha}& & $\langle100\rangle$ & 42420 & 251 & 0.87 & 62\\
& Hole & $\langle111\rangle$ & 107270 & 100 & 0.58 & 0 \\
& & $\langle100\rangle$ & 66333 & 181 & 0.744 & 0 \\\hline\hline
& Electron & $\langle111\rangle$ & 38536 & 538 & 0.641 & 510 \\
Ref.~\cite{bart}& & $\langle100\rangle$ & 38609 & 511 & 0.805 & -171\\ 
& Hole & $\langle111\rangle$ & 61215 & 182 & 0.662 & 0 \\
& & $\langle100\rangle$ & 61824 & 185 & 0.942 & 0 \\\hline\hline
  \end{tabular*}
  \caption{Fit parameters for the experimental drift velocities in the 
$\langle111\rangle$ and $\langle100\rangle$ directions.}
\label{tab:pss:pars}
\end{table}

The anisotropy in any direction is related to the longitudinal anisotropy in the $\langle100\rangle$ and $\langle111\rangle$ directions. The drift velocity in any direction can be calculated accordingly. The detailed calculation will be described in the following two sections.

It is very important to distinguish two different coordinate systems in the calculation. One is the coordinate defined by the crystal axes $\langle100\rangle$, $\langle010\rangle$ and $\langle001\rangle$. They are perpendicular to each other hence can be used as the axes of a Cartesian coordinate. The other one, indicated as $xyz$ in Fig~\ref{fig:pss:coo}, is used in Geant4 geometry modeling. When you construct your detector as a Geant4 tube, the locate coordinate system attached to this tube is shown in Fig~\ref{fig:pss:coo} as $xyz$. Our germanium detector has a cylindrical shape. The crystal is produced such that its $\langle001\rangle$ axis is aligned with the middle axis of the cylinder, \textit{i.e.} aligned with the z-axis of the coordinate used in Geant4 simulation. So the relation between the two coordinates can be described by an angle between the $\langle110\rangle$ axis and the y-axis, $\phi_{110}$.
\begin{figure}[htpb]
  \centering
  \includegraphics[width=0.5\textwidth]{coordins}  
  \caption{The relation between the coordinate $xyz$ used in Geant4     simulation and the one defined by the crystal axes     $\langle100\rangle$, $\langle010\rangle$ and $\langle001\rangle$.}
  \label{fig:pss:coo}
\end{figure}

\subsection{Electron drift velocity}
\label{sec:pss:elec}
There are four ellipsoidal valleys in the germanium crystal lying along the $\langle111\rangle$ directions as shown in Fig~\ref{fig:pss:valley}. Electrons mostly populate in them and can be easily accelerated by the external electrical field. The population of electrons in other directions is very small and is neglected in the following calculation.
\begin{figure}[htpb]
  \centering
  \includegraphics[width=0.5\textwidth]{valleys}  
  \caption{Four ellipsoidal valleys along $\langle111\rangle$     directions, where electrons mostly populate.}
  \label{fig:pss:valley}
\end{figure}

Only considering the effect of the four ellipsoidal valleys shown in Fig~\ref{fig:pss:valley}, the dependence of the electron drift velocity $\mathbf{v}_{e}$ on the applied electric field $\mathbf{E}$ is taken to be
\begin{equation}
  \label{eq:pss:ed}
  \mathbf{v}_{e}(\mathbf{E}) = \mathcal{A}(E) \sum_{j}     \frac{n_{j}}{n} \frac{\gamma_{j}\mathbf{E_{0}}}           {\sqrt{\mathbf{E_{0}}\gamma_{j}\mathbf{E_{0}}}}, \mbox{ with }           j=1,2,3,4
\end{equation}
where $\mathcal{A}$ is a function of the magnitude of the electric field $E=|\mathbf{E}|$ and temperature, the value of $\mathcal{A}$ must be negative because electrons drift to the opposite direction of the electric field; $\mathbf{E_{0}}$ is the normalized electric field vector; $n_{j}/n$ is the fraction of the carriers (in this case, electrons) in the $j$-th $\langle111\rangle$ valley, $\gamma_{j}$ is the effective mass tensor for the $j$-th $\langle111\rangle$ valley. In the local coordinate of one of the ellipsoidal valleys $x^{\prime}y^{\prime}z^{\prime}$, as shown in Fig.~\ref{fig:pss:axes}, the effective mass tensor has a very simple expression:
\begin{equation}
  \label{eq:pss:g0}
  \gamma_{0} \equiv \left(
    \begin{array}{ccc}
      m_{t}^{-1} & 0 & 0 \\
      0 & m_{l}^{-1} & 0 \\
      0 & 0 & m_{t}^{-1}
    \end{array} \right),
\end{equation}
where $m_{t} = 1.64m_{e}$ is the transversal effective electron mass, $m_{l} = 0.0819m_{e}$ is the longitudinal effective electron mass, with $m_{e}$ denoting the free electron mass. Since it is convenient to simulate the interactions and the pulse shape developing in the same coordinate $xyz$, as shown in Fig.~\ref{fig:pss:coo} and \ref{fig:pss:axes}, we have to calculate the expressions of $\gamma_{j}$'s in $xyz$:
\begin{equation}
  \label{eq:pss:gs}
  \gamma_{j} = R_{j}^{-1}\gamma_{0}R_{j} = R_{j}^{T}\gamma_{0}R_{j},
\end{equation}
where
\begin{equation}
  \label{eq:pss:rs}
  R_{j} = R_{x^{\prime}}(\arccos(\sqrt{2/3}))R_{z}(\phi_{110}+(j-1)\pi/2)
\end{equation}
is the rotation matrix which could align $\langle111\rangle$ axis to the y-axis. The suffix of $R$'s indicate the rotation axes. The rotation angles are denoted in the brackets following the $R$'s. All the rotations are defined in the counter-clockwise sense.

\begin{figure}[tbhp]
  \centering
  \includegraphics[width=0.5\textwidth]{axes}  
  \caption{Relation between the local coordinate     $x^{\prime}y^{\prime}z^{\prime}$ of one of the four ellipsoidal     valleys and the Geant4 coordinate $xyz$. The $x^{\prime}$ axis is     perpendicular to the plane defined by $\langle111\rangle$ and     $\langle001\rangle$.}
  \label{fig:pss:axes}
\end{figure}

For an experimental determination of the repopulation amplitude, the deviation from a uniform population distribution $n_{e}/n$ (1/4 for germanium) is assumed to vary with the electric field weighted by the factor $\mathcal{R}$:
\begin{equation}
  \label{eq:pss:nion}
  \frac{n_{j}}{n} = \mathcal{R}(E)   \left[         \frac{\sqrt{\mathbf{E_{0}}\gamma_{j}\mathbf{E_{0}}}}
    {\sum_{i}\sqrt{\mathbf{E_{0}}\gamma_{i}\mathbf{E_{0}}}} -               \frac{n_{e}}{n} \right] + \frac{n_{e}}{n}, 
\end{equation}

If the electric field vector is equally oriented with respect to all the $\langle111\rangle$ directions, there is an uniform repopulation of the conduction bands, \textit{i.e.} $n_{j}/n = 1/4$. An electric field applied along the $\langle100\rangle$ direction, \textit{i.e.} $\mathbf{E_{0}} = (\sqrt{1/2},\sqrt{1/2},0)^{T}$ in coordinate $xyz$, satisfies this condition. By employing the experimental drift velocity $v_{e}^{100}(E)$ which can be calculated using Eq.~\ref{eq:pss:para}, the absolute value of $\mathcal{A}(E)$ can be calculated as
\begin{equation}
  \label{eq:pss:ae}
  |\mathcal{A}(E)| = \frac{v_{e}^{100}(E)}  {\displaystyle \sum_{j}     \frac{1}{4}     \frac{\gamma_{j}\mathbf{E_{0}}}         {\sqrt{\mathbf{E_{0}}\gamma_{j}\mathbf{E_{0}}}} },  \mbox{ with }       \mathbf{E_{0}} = \left( \begin{array}{c} 
    \sqrt{1/2}\\\sqrt{1/2}\\0 \end{array} \right).
\end{equation}

If the electric field vector is oriented along with one of the $\langle111\rangle$ directions, \textit{i.e.} $\mathbf{E_{0}} = (0,\sqrt{2/3},\sqrt{1/3})^{T}$ in coordinate $xyz$, there is an uniform repopulation of the conduction bands among the other three $\langle111\rangle$ axes, \textit{i.e.}
\begin{equation}
  \label{eq:pss:n111}
  \frac{n_{2}}{n} = \frac{n_{3}}{n} = \frac{n_{4}}{n}.
\end{equation}
Since
\begin{equation}
  \label{eq:pss:nsum}
  \displaystyle \sum_{j}\frac{n_{j}}{n} = 1,
\end{equation}
we have
\begin{equation}
  \label{eq:pss:n12}
  \frac{n_{1}}{n} + 3\frac{n_{2}}{n}= 1.
\end{equation}
By employing the experimental drift velocity $v_{e}^{111}(E)$ for an applied electric field $E$ in the $\langle111\rangle$ direction at a specific temperature, which can be calculated using Eq.~\ref{eq:pss:para}, we have another relation between $n_{1}/n$ and $n_{2}/n$:
\begin{equation}
  \label{eq:pss:n12p}
  v_{e}^{111}(E) =  \mathcal{A}(E) \left(  \frac{n_{1}}{n} \frac{\gamma_{1}\mathbf{E_{0}}}         {\sqrt{\mathbf{E_{0}}\gamma_{1}\mathbf{E_{0}}}} +  3\frac{n_{2}}{n} \frac{\gamma_{2}\mathbf{E_{0}}}         {\sqrt{\mathbf{E_{0}}\gamma_{2}\mathbf{E_{0}}}} \right).
\end{equation}
One can get the value of $n_{1}/n$ and $n_{2}/n$ by solving the equations \ref{eq:pss:n12} and \ref{eq:pss:n12p} together. Then $\mathcal{R}(E)$ can be calculated as
\begin{equation}
  \label{eq:pss:re}
  \mathcal{R}(E) = \left( \frac{n_{1}}{n} - \frac{n_{e}}{n} \right) / \left( \frac{\sqrt{\mathbf{E_{0}}\gamma_{1}\mathbf{E_{0}}}}
    {\sum_{j}\sqrt{\mathbf{E_{0}}\gamma_{j}\mathbf{E_{0}}}} -                           \frac{n_{e}}{n} \right), \mbox{ with } \mathbf{E_{0}} = \left( \begin{array}{c} 
  0\\ \sqrt{2/3}\\\sqrt{1/3} \end{array} \right).
\end{equation}

After determination of the parameters $\mathcal{A}$ and $\mathcal{R}$, the drift velocity can be calculated for any direction and any strength of the electric field.

\subsection{Hole drift velocity}
\label{sec:pss:hole}
The model used in calculating the hole drift velocity is taken from Ref.~\cite{bart}. In this model the so-called heavy hole valence band is solely responsible for the anisotropic mobility while the other effects are neglected. The holes are accelerated in the electrical field until their energy becomes 0.037~eV. At this point their energy is sufficiently large to emit an optical phonon, a process which is very likely to happen. By emitting an optical phonon, the hole typically loses most of its energy and resumes acceleration in the field direction and a new cycle starts. 

From this picture, the properties of the probability distribution function for finding a heavy hole in a specific momentum state, $\mathbf{k}$, can be predicted. The distribution should peak in the direction in which $\mathbf{k}$ is parallel to the electrical field. So the mean wave vector $\mathbf{k}_{0}(k_{0}, \theta_{0}, \phi_{0})$ is assumed to be aligned with the applied electrical field $\mathbf{E}(E, \theta, \phi)$, \textit{i.e.} $\theta_{0} = \theta, \phi_{0} = \phi$, where $\theta, \phi$ are the polar and azimuthal angles with respect to the coordinate defined by the $\langle100\rangle$, $\langle010\rangle$ and $\langle001\rangle$ axes as shown in Fig.~\ref{fig:pss:vsphere}.
\begin{figure}[tbhp]
  \centering
  \includegraphics[width=0.4\textwidth]{vsphere}  
  \caption{Relation between the coordinate defined by the crystal
$\langle100\rangle$, $\langle010\rangle$ and $\langle001\rangle$ axes,
the one used in the Geant4 simulation, $xyz$ and the local coordinate
$x^{\prime}y^{\prime}z^{\prime}$ attached to each position.}
  \label{fig:pss:vsphere}
\end{figure}

The three components $(v_{x^{\prime}}, v_{y^{\prime}}, v_{z^{\prime}})^{T}$ of the hole drift velocity $\mathbf{v}$ in the local coordinate $x^{\prime}y^{\prime}z^{\prime}$ at any position $(r, \theta, \phi)$ (as shown in Fig.~\ref{fig:pss:vsphere}) can be expressed as:
\begin{equation}
  \label{eq:pss:vsphere}
  \begin{array}{rcl}
   v_{x^{\prime}} = v_{r} &=& v^{100}_{h}(E)[1-\Lambda(k_{0})(\sin(\theta)^{4}\sin(2\phi)^{2} + \sin(2\theta)^{2})],\\
   v_{y^{\prime}} = v_{\theta} &=& v^{100}_{h}(E)\Omega(k_{0})[2\sin(\theta)^{3}\cos(\theta)\sin(2\phi)^{2} + \sin(4\theta)],\\
    v_{z^{\prime}} = v_{\phi} &=& v^{100}_{h}(E)\Omega(k_{0})\sin(\theta)^{3}\sin(4\phi).
  \end{array}
\end{equation}
The mean wave number $k_{0}$ can be expressed as a function of $v_{rel} = v^{111}_{h}(E)/v^{100}_{h}(E)$:
\begin{equation}
  \label{eq:pss:k0}
   k_{0}(v_{rel}) = 9.2652 - 26.3467v_{rel} + 29.6137v_{rel}^{2} - 12.3689v_{rel}^{3},
\end{equation}
where $v^{111}_{h}(E)$ and $v^{100}_{h}(E)$ indicate the drift velocity along the $\langle111\rangle$ and $\langle100\rangle$ direction. They can be calculated using Eq.~\ref{eq:pss:para}. The function $\Lambda$ and $\Omega$ govern the amplitude of the anisotropy and can be expressed as
\begin{equation}
  \label{eq:pss:lamb}
   \Lambda(k_{0}) = -0.01322k_{0} + 0.41145k_{0}^{2} - 0.23657k_{0}^{3} + 0.04077k_{0}^{4},
\end{equation}
\begin{equation}
  \label{eq:pss:ome}
   \Omega(k_{0}) = 0.006550k_{0} - 0.19946k_{0}^{2} + 0.09859k_{0}^{3} - 0.01559k_{0}^{4}.
\end{equation}

The three components $(v_{x}, v_{y}, v_{z})^{T}$ of the hole drift velocity $\mathbf{v}$ in the coordinate $xyz$ (as shown in Fig.~\ref{fig:pss:vsphere}) can be calculated as:
\begin{equation}
  \label{eq:pss:v2v}  
  \left(
    \begin{array}{c}
      v_{x} \\ v_{y} \\ v_{z}
    \end{array}
\right) = R_{z}(\phi + \frac{\pi}{4} + \phi_{110}) R_{y^{\prime}}(\theta) \left( 
    \begin{array}{c}
      v_{x^{\prime}} \\ v_{y^{\prime}} \\ v_{z^{\prime}}
    \end{array} \right),
\end{equation}
where $R$'s indicate the rotation matrix along a specific axis, such as $y^{\prime}$ or $z$. The rotation angles are denoted in the following brackets. All the rotations are defined in the counter-clockwise sense.



%%% Local Variables:
%%% mode:latex
%%% TeX-master: "thesis"
%%% End:
